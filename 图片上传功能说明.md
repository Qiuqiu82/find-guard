# 图片上传功能说明

## 功能概述

图片上传功能允许用户添加自定义图片到游戏中，创建新的关卡。该功能集成在关卡编辑器中，提供完整的图片管理解决方案。

## 使用方法

### 1. 进入关卡编辑器
- 在游戏主页面连续点击5次主页图标
- 编辑器界面将弹出，显示所有现有关卡

### 2. 上传新图片
在"添加新图片"部分，有两种上传方式：

#### 方式一：点击选择
- 点击"选择图片"按钮
- 在文件选择器中选择图片文件
- 支持的文件格式：JPG、PNG、WebP

#### 方式二：拖拽上传
- 直接将图片文件拖拽到上传区域
- 支持所有主流图片格式
- 提供视觉反馈（拖拽时高亮显示）

## 技术特性

### 文件验证
- **文件类型检查**：只接受图片文件（MIME类型以image/开头）
- **文件大小限制**：最大5MB，防止过大文件影响性能
- **格式支持**：JPG、PNG、WebP等主流格式

### 图片质量检查
- **尺寸检测**：自动检测图片的原始尺寸
- **建议尺寸**：1920×945像素（与现有图片保持一致）
- **容差范围**：允许20%的尺寸差异
- **用户提示**：当尺寸不符合建议时，会询问是否继续

### 自动处理
- **Base64编码**：自动将图片转换为Base64格式存储
- **关卡创建**：自动创建新的游戏关卡
- **编辑模式**：上传成功后自动进入编辑模式

## 图片要求

### 推荐规格
- **尺寸**：1920×945像素
- **格式**：JPG、PNG、WebP
- **文件大小**：≤5MB
- **质量**：清晰、无压缩失真

### 注意事项
- 图片尺寸差异过大会影响游戏体验
- 建议使用横向图片，符合游戏界面布局
- 图片内容应包含明显的可疑点，便于设置警示区域

## 管理功能

### 图片列表
- 显示所有已上传的图片
- 显示每张图片的警示点数量
- 点击图片可进入编辑模式

### 删除功能
- 每张图片右上角有删除按钮（×）
- 删除前会要求确认
- 删除后自动调整关卡编号

### 数据导出/导入
- **导出**：将当前关卡数据导出为JSON文件
- **导入**：从JSON文件导入关卡数据
- **备份**：可用于数据备份和迁移

## 编辑功能

### 警示点设置
- 点击图片区域绘制警示框
- 设置警示点的标题和详细说明
- 选择连接线类型（水平、垂直-水平）

### 绘制功能
- **开始绘制**：点击"开始绘制"按钮进入绘制模式
- **拖拽绘制**：按住鼠标左键拖拽绘制警示框
- **实时预览**：绘制过程中实时显示警示框位置和大小
- **尺寸验证**：自动验证绘制区域的最小尺寸（10×10像素）
- **取消绘制**：按ESC键或点击"取消绘制"按钮
- **绘制提示**：清晰的视觉提示和操作指导

### 连接线预览
- **实时预览**：编辑警示点时实时显示连接线效果
- **类型选择**：支持横线和先竖后横两种连接线类型
- **视觉反馈**：连接线带有阴影效果，清晰可见
- **位置计算**：自动计算连接线的正确位置和方向

### 实时预览
- 编辑过程中实时显示警示框
- 支持调整警示框位置和大小
- 预览最终效果

## 错误处理

### 常见错误及解决方案

#### 文件类型错误
- **错误**：选择非图片文件
- **解决**：选择正确的图片格式文件

#### 文件过大
- **错误**：文件超过5MB限制
- **解决**：压缩图片或选择较小的文件

#### 图片加载失败
- **错误**：图片文件损坏或格式不支持
- **解决**：检查文件完整性，尝试其他格式

#### 尺寸警告
- **提示**：图片尺寸与建议尺寸差异较大
- **选择**：用户可选择继续使用或重新选择

## 最佳实践

### 图片准备
1. 使用图像编辑软件调整尺寸至1920×945
2. 确保图片质量清晰，无明显压缩痕迹
3. 选择适合的图片格式（JPG适合照片，PNG适合图形）

### 警示点设计
1. 选择明显的可疑区域作为警示点
2. 警示框大小适中，便于玩家识别
3. 提供清晰的标题和详细说明

### 数据管理
1. 定期导出关卡数据作为备份
2. 测试新添加的关卡是否正常工作
3. 删除不需要的图片以节省存储空间

## 技术实现

### 前端技术
- **Vue 3 Composition API**：响应式状态管理
- **FileReader API**：文件读取和处理
- **Canvas API**：图片尺寸检测
- **Drag & Drop API**：拖拽上传支持

### 数据存储
- **Base64编码**：图片数据内嵌存储
- **LocalStorage**：本地数据持久化
- **JSON格式**：标准数据交换格式

### 性能优化
- **文件大小限制**：防止内存占用过大
- **异步处理**：不阻塞用户界面
- **错误边界**：优雅处理各种异常情况

## 更新日志

### v1.0.0
- 基础图片上传功能
- 文件类型和大小验证
- 图片尺寸检测
- 拖拽上传支持

### v1.1.0
- 添加图片删除功能
- 优化用户界面和交互
- 增强错误处理和提示

### v1.2.0
- 添加数据导出/导入功能
- 改进拖拽上传体验
- 完善文档和说明

## 技术支持

如遇到问题或需要帮助，请：
1. 检查浏览器控制台的错误信息
2. 确认图片文件格式和大小
3. 尝试刷新页面重新操作
4. 联系技术支持团队 